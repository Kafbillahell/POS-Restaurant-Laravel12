$(function(){
  // ==============================================================  
  // Donut C3 (tetap statis)  
  // ==============================================================  
  c3.generate({
    bindto: "#campaign-v2",
    data: {
      columns: [
        ["Direct Sales", 25],
        ["Referral Sales", 15],
        ["Afilliate Sales", 10],
        ["Indirect Sales", 15]
      ],
      type: "donut",
      tooltip: { show: true }
    },
    donut: { label: { show: false }, title: "Sales", width: 18 },
    legend: { hide: true },
    color: { pattern: ["#edf2f6","#5f76e8","#ff4f70","#01caf1"] }
  });
  d3.select("#campaign-v2 .c3-chart-arcs-title")
    .style("font-family","Rubik");

  // ==============================================================  
  // Bar Chart per-kasir: pendapatan, komisi, keuntungan  
  // ==============================================================  
  new Chartist.Bar(".net-income", {
    labels: window.chartData.labels,
    series: [
      window.chartData.pendapatan,
      window.chartData.komisi,
      window.chartData.keuntungan
    ]
  }, {
    axisX: { showGrid: false },
    seriesBarDistance: 10,
    chartPadding: { top: 15, right: 15, bottom: 5, left: 0 },
    plugins: [ Chartist.plugins.tooltip() ],
    width: "100%",
    axisY: {
      onlyInteger: true,
      offset: 40,
      labelInterpolationFnc: function(v) {
        return 'Rp ' + v.toLocaleString();
      }
    }
  }, [
    ["screen and (max-width: 640px)", {
      seriesBarDistance: 5,
      axisX: {
        labelInterpolationFnc: function(v) { return v[0]; }
      }
    }]
  ]);

  // ==============================================================  
  // Line Chart 7-hari: keuntungan per hari (bisa diabaikan jika fokus per bulan)  
  // ==============================================================  
  var line = new Chartist.Line(".stats", {
    labels: window.chartData.earningLabels,
    series: [ window.chartData.earningValues ]
  }, {
    low: 0,
    showArea: true,
    fullWidth: true,
    plugins: [ Chartist.plugins.tooltip() ],
    axisY: {
      onlyInteger: true,
      offset: 40,
      labelInterpolationFnc: function(v) {
        return 'Rp ' + v.toLocaleString();
      }
    }
  });
  line.on("draw", function(ctx){
    if(ctx.type === "area"){
      ctx.element.attr({ x1: ctx.x1 + 0.001 });
    }
  });
  line.on("created", function(ctx){
    var defs = ctx.svg.elem("defs");
    defs.elem("linearGradient", { id: "gradient", x1: 0, y1: 1, x2: 0, y2: 0 })
      .elem("stop", { offset: 0, "stop-color": "rgba(255,255,255,1)" })
      .parent().elem("stop", { offset: 1, "stop-color": "rgba(80,153,255,1)" });
  });
  $(window).on("resize", function(){ line.update(); });
});
